# BeautyCita iOS App

This is the iOS native wrapper for the BeautyCita web application using Capacitor.

## Prerequisites

- macOS with Xcode 14+ installed
- CocoaPods installed (`sudo gem install cocoapods`)
- Node.js and npm

## Project Structure

```
ios/
├── App/                          # Xcode project
│   ├── App.xcodeproj/           # Xcode project file
│   ├── App.xcworkspace/         # Xcode workspace (use this to open)
│   ├── App/                     # iOS app source
│   │   ├── AppDelegate.swift   # Main app delegate
│   │   ├── Assets.xcassets/    # App icons and assets
│   │   ├── Info.plist          # App configuration
│   │   └── public/             # Web assets (generated, not in git)
│   └── Podfile                 # CocoaPods dependencies
└── capacitor-cordova-ios-plugins/  # Capacitor plugins (generated)
```

## Build Process

### 1. Build the Web App (from /frontend directory)

```bash
cd /var/www/beautycita.com/frontend
npm run build
```

This creates the `dist` folder with the compiled web application.

### 2. Sync Web Assets to iOS

```bash
npx cap sync ios
```

This command:
- Copies `dist` → `ios/App/App/public`
- Updates Capacitor configuration
- Installs CocoaPods dependencies
- Updates native plugins

### 3. Open in Xcode

```bash
npx cap open ios
```

Or manually open: `App/App.xcworkspace` (NOT .xcodeproj)

### 4. Build and Run

In Xcode:
1. Select a simulator or connected device
2. Click the Play button or press ⌘R
3. App will build and launch

## Capacitor Plugins

The app uses these Capacitor plugins:
- `@aparajita/capacitor-biometric-auth@9.0.0` - Touch ID / Face ID authentication
- `@capacitor/app@7.1.0` - App lifecycle events
- `@capacitor/preferences@7.0.2` - Persistent storage
- `@capacitor/splash-screen@7.0.3` - Splash screen management
- `@capacitor/status-bar@7.0.3` - Status bar styling

## Configuration

### App Information
- **App ID**: `com.beautycita.app`
- **App Name**: BeautyCita
- **Bundle ID**: com.beautycita.app

### Capacitor Config
See `../../capacitor.config.json` for configuration:
- Splash screen: 2s duration, pink background (#ec4899)
- Status bar: Dark style with pink background
- Android scheme: HTTPS (for security)

## Testing

### Simulator Testing
```bash
# List available simulators
xcrun simctl list devices

# Build and run on specific simulator
xcodebuild -workspace App/App.xcworkspace -scheme App -destination 'platform=iOS Simulator,name=iPhone 15' build
```

### Physical Device Testing
1. Connect iPhone/iPad via USB
2. Trust the computer on the device
3. Select device in Xcode
4. Enable "Automatically manage signing" in Xcode
5. Select your development team
6. Build and run

## Important Notes

### DO NOT commit these folders:
- `App/App/public/` - Generated from web build
- `App/Pods/` - CocoaPods dependencies
- `App/build/` - Xcode build artifacts
- `capacitor-cordova-ios-plugins/` - Generated plugin files

These are regenerated by `npx cap sync ios`.

### After Making Web Changes:
Always run the sync process to update the iOS app:
```bash
npm run build && npx cap sync ios
```

### After Updating Capacitor or Plugins:
```bash
cd App
pod install
```

## Troubleshooting

### CocoaPods Issues
```bash
cd App
pod deintegrate
pod install --repo-update
```

### Clean Build
In Xcode: Product → Clean Build Folder (⌘⇧K)

### Reset Everything
```bash
cd /var/www/beautycita.com/frontend
rm -rf ios
npx cap add ios
npx cap sync ios
```

## App Store Deployment

### 1. Update Version
Edit `App/App/Info.plist`:
- CFBundleShortVersionString: User-facing version (e.g., "1.0.0")
- CFBundleVersion: Build number (e.g., "1")

### 2. Archive Build
1. Select "Any iOS Device" as target
2. Product → Archive
3. Wait for build to complete
4. Organizer window opens automatically

### 3. Upload to App Store Connect
1. In Organizer, click "Distribute App"
2. Select "App Store Connect"
3. Follow the wizard
4. Wait for upload and processing

### 4. Submit for Review
1. Go to App Store Connect
2. Create new version
3. Add screenshots and metadata
4. Submit for review

## Links

- [Capacitor Documentation](https://capacitorjs.com/docs)
- [iOS Human Interface Guidelines](https://developer.apple.com/design/human-interface-guidelines/ios)
- [App Store Connect](https://appstoreconnect.apple.com)

## Support

For issues with:
- Web functionality: Check `/frontend/src/`
- iOS native code: Check `App/App/AppDelegate.swift`
- Capacitor plugins: Check plugin documentation
- Build issues: Check Xcode build logs
